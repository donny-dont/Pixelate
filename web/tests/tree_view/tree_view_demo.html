<!DOCTYPE html>

<html>
  <head>
    <title>Tree View test</title>

    <style>
      #colors {
        width: 220px;
        height: 300px;
        background-color: #666;
      }
    </style>

    <!-- Import the elements -->
    <link rel="import" href="packages/pixelate/components/tree_view/tree_view.html">
    <link rel="import" href="packages/pixelate/components/tree_view/tree_view_node.html">
    
    <!-- Polymer initialization -->
    <script src="packages/browser/dart.js"></script>
  </head>
  <body>
    <div id="colors">
      <px-tree-view id="scene">
        <px-tree-view-node text="Meshes" icon="icons/mesh2.png">
          <px-tree-view-node text="Truck01" icon="icons/mesh.png"></px-tree-view-node>
          <px-tree-view-node text="Truck02" icon="icons/mesh.png"></px-tree-view-node>
          <px-tree-view-node text="Prop01.mesh" icon="icons/mesh.png"></px-tree-view-node>
          <px-tree-view-node text="Orc.mesh" icon="icons/mesh.png">
            <px-tree-view-node text="Vertices: 2405" icon="icons/stats.png"></px-tree-view-node>
            <px-tree-view-node text="Edges: 1642" icon="icons/stats.png"></px-tree-view-node>
          </px-tree-view-node>
          <px-tree-view-node text="Orc.skeleton" icon="icons/skeleton.png">
            <px-tree-view-node text="root" icon="icons/bone.png">
              <px-tree-view-node text="lower_back" icon="icons/bone.png">
                <px-tree-view-node text="upper_back" icon="icons/bone.png">
                  <px-tree-view-node text="neck" icon="icons/bone.png">
                    <px-tree-view-node text="sholder.left" icon="icons/bone.png">
                      <px-tree-view-node text="elbow.left" icon="icons/bone.png">
                        <px-tree-view-node text="palm.left" icon="icons/bone.png">
                          <px-tree-view-node text="finger1.left" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger2.left" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger3.left" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger4.left" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger5.left" icon="icons/bone.png"></px-tree-view-node>
                        </px-tree-view-node>
                      </px-tree-view-node>
                    </px-tree-view-node>
                    <px-tree-view-node text="head" icon="icons/bone.png"></px-tree-view-node>
                    <px-tree-view-node text="sholder.right" icon="icons/bone.png">
                      <px-tree-view-node text="elbow.right" icon="icons/bone.png">
                        <px-tree-view-node text="palm.right" icon="icons/bone.png">
                          <px-tree-view-node text="finger1.right" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger2.right" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger3.right" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger4.right" icon="icons/bone.png"></px-tree-view-node>
                          <px-tree-view-node text="finger5.right" icon="icons/bone.png"></px-tree-view-node>
                        </px-tree-view-node>
                      </px-tree-view-node>
                    </px-tree-view-node>
                  </px-tree-view-node>
                </px-tree-view-node>
              </px-tree-view-node>
              <px-tree-view-node text="hip.left" icon="icons/bone.png">
                <px-tree-view-node text="knee.left" icon="icons/bone.png">
                  <px-tree-view-node text="feet.left" icon="icons/bone.png">
                  </px-tree-view-node>
                </px-tree-view-node>
              </px-tree-view-node>
              <px-tree-view-node text="hip.right" icon="icons/bone.png">
                <px-tree-view-node text="knee.right" icon="icons/bone.png">
                  <px-tree-view-node text="feet.right" icon="icons/bone.png">
                  </px-tree-view-node>
                </px-tree-view-node>
              </px-tree-view-node>
            </px-tree-view-node>
          </px-tree-view-node>
        </px-tree-view-node>
        <px-tree-view-node text="Lights" icon="icons/lamp.png">
          <px-tree-view-node text="Sun" icon="icons/lamp.png"></px-tree-view-node>
          <px-tree-view-node text="PointLight01" icon="icons/lamp.png"></px-tree-view-node>
          <px-tree-view-node text="PointLight01" icon="icons/lamp.png"></px-tree-view-node>
          <px-tree-view-node text="LampSpotLightRed" icon="icons/lamp.png"></px-tree-view-node>
        </px-tree-view-node>
        <px-tree-view-node text="Cameras" icon="icons/camera.png">
          <px-tree-view-node text="PlayerCam" icon="icons/camera.png"></px-tree-view-node>
          <px-tree-view-node text="ReplayCam" icon="icons/camera.png"></px-tree-view-node>
          <px-tree-view-node text="TopViewCam" icon="icons/camera.png"></px-tree-view-node>
        </px-tree-view-node>
      </px-tree-view>
    </div>
    
    <button id="btnRemoveNode">Remove Node</button>
    <button id="btnAddSibling">Add Sibling</button>
    <button id="btnAddChild">Add Child</button>
    
    <script type="application/dart">
    	//export 'package:polymer/init.dart';
    	import "package:polymer/polymer.dart";
    	import "dart:html";
    	import "package:pixelate/components/tree_view/tree_view.dart";
    	import "package:pixelate/components/tree_view/tree_view_node.dart";
    	
    	TreeView treeView;
    	main() {
    	  initPolymer().run(() {
    	    treeView = querySelector("#scene");
    	    querySelector("#btnRemoveNode").onClick.listen(onRemove);
    	    querySelector("#btnAddChild").onClick.listen(onAddChild);
    	    querySelector("#btnAddSibling").onClick.listen(onAddSibling);
    	  });
    	}
    	
    	void onRemove(Event e) {
    	  TreeViewNode selected = treeView.selectedNode;
    	  if (selected != null) {
	      	  selected.remove();
    	  }
    	}
    	
    	void onAddChild(Event e) {
    	  TreeViewNode selected = treeView.selectedNode;
    	  if (selected != null) {
    	      print ("Adding child");
	      	  var node = _createNewNode();
	      	  selected.nodes.insert(0, node);
	      	  selected.expanded = true;
    	  }
    	}
    	
    	void onAddSibling(Event e) {
    	  TreeViewNode selected = treeView.selectedNode;
    	  if (selected != null) {
    	  	// Find the index of this selected item so we can insert it after it
    	  	int index = selected.parent.nodes.indexOf(selected);
      	  	var node = _createNewNode();
    	  	selected.parent.nodes.insert(index + 1, node);
    	  }
    	}
    	
    	/** Creates a tree node object with an icon and some text */
    	TreeViewNode _createNewNode() {
    	  TreeViewNode treeNode = new Element.tag(TreeViewNode.customTagName);
    	  treeNode.text = "Tree Node ${_nodeCounter++}";
    	  var icons = ["bone", "camera", "lamp", "mesh", "mesh2", "skeleton", "stats"];
    	  treeNode.icon = "icons/${icons[_nodeCounter % icons.length]}.png";
    	  return treeNode;
    	}
    	int _nodeCounter = 0;
    	
    	
    </script>
  </body>
</html>
